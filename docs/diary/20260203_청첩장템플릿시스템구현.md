# 2026-02-03: 청첩장 템플릿 시스템 구현 (Classic 템플릿)

## 작업한 내용

### 1. 우선순위 재정립
- Admin Phase 2 (Quick Actions, Recent Activity) 스킵 결정
- MVP 핵심 기능 우선: 청첩장 템플릿 → 생성 → 조회 → RSVP
- `docs/roadmap.md` 작성 (3개월 MVP 로드맵)

### 2. 데이터 스키마 구축
- **Zod 스키마** (`schemas/invitation.ts`)
  - DB 스키마 기반으로 확장된 타입 정의
  - CreateInvitationSchema, UpdateInvitationSchema
  - 런타임 검증 + TypeScript 타입 추론
  - 샘플 데이터 (SAMPLE_INVITATION)

### 3. 날짜 포맷 유틸리티
- **`lib/utils/date.ts`** 생성
- date-fns 의존성 제거 → 네이티브 `Intl.DateTimeFormat` 사용
- `formatWeddingDate()`, `formatWeddingTime()`, `formatWeddingDateTime()`
- 한국어 로케일 (ko-KR) 지원

### 4. Classic 템플릿 구현
- **`components/templates/ClassicTemplate.tsx`**
- 모바일 우선 디자인 (375px 기준)
- 주요 섹션:
  - 커버 (이름, 날짜, 장소)
  - 인사말
  - 신랑/신부 정보 (부모님, 전화번호)
  - 예식 정보 (일시, 장소, 안내사항)
  - 갤러리 (구조만, 이미지 추후)
  - 계좌번호
  - Footer
- Framer Motion 애니메이션 (ScrollFade, hover)
- 반응형: `text-sm md:text-base`, `py-12 md:py-20`
- 터치 타겟: `min-h-[44px]` (접근성)

### 5. 미리보기 페이지
- `/templates/preview` - Classic 템플릿 + 샘플 데이터

### 6. 모바일 CSS 최적화
- 커버 높이: `h-screen` → `min-h-[70vh]`
- 폰트 크기 조정 (text-3xl → text-2xl md:text-3xl)
- 여백 최적화 (py-20 → py-12 md:py-20)
- 스크롤 인디케이터 제거 (모바일에서 불필요)

### 7. Beads 이슈 생성
- `cuggu-skm`: Admin 템플릿 선택 UI 구현 (P2)

---

## 왜 했는지 (맥락)

### 문제 인식
1. **Admin Phase 2가 의미 없음**
   - Quick Actions, Recent Activity 등은 핵심 기능 없이는 빈 껍데기
   - 청첩장 생성 기능이 없는데 UI만 화려해봤자 무용지물

2. **MVP 출시 목표 불명확**
   - 3개월 목표인데 핵심 기능 0%
   - 인프라만 완성, 실제 가치 제공 못함

### 결정
- **핵심 기능 먼저**: 청첩장 템플릿 → 생성 → 공유 → RSVP
- **템플릿부터 시작**: E2E의 시작점, 시각적 결과물

---

## 논의/아이디어/고민

### 1. date-fns vs 네이티브 Intl
**문제**: date-fns import 에러 (Turbopack 호환성?)

**선택지**:
- A. date-fns 설치 및 설정 수정
- B. 네이티브 `Intl.DateTimeFormat` 사용

**결정**: B 선택
- 의존성 감소 (bundle size ↓)
- Intl은 브라우저 네이티브, 빠름
- 한국어 로케일 지원 충분

**트레이드오프**:
- 복잡한 날짜 연산은 Intl로 어려움 (나중에 필요 시 추가)
- 현재는 포맷팅만 필요해서 OK

### 2. 템플릿 데이터 구조
**고민**: DB 스키마가 기본 필드만 있음 (groomName, brideName, weddingDate 등)

**해결**:
- Zod 스키마로 확장된 구조 정의 (부모님, 계좌, 설정 등)
- DB는 나중에 `content JSON` 필드 추가하거나 별도 컬럼 추가 예정
- 현재는 샘플 데이터로 UI 먼저 완성

### 3. 모바일 최적화 기준
**발견**: 첫 구현 시 데스크톱 기준으로 만들어서 모바일에서 문제
- 커버가 너무 김 (h-screen)
- 폰트가 너무 큼
- 터치 타겟 작음

**해결**:
- 모바일 우선 설계 (375px 기준)
- 모든 크기를 `base md:lg` 형태로 반응형 작성
- 터치 타겟 44px 최소 확보 (WCAG 가이드라인)

---

## 결정된 내용

### 아키텍처
1. **Zod 스키마 = Single Source of Truth**
   - 타입 정의 + 런타임 검증
   - API 요청/응답 모두 Zod로 파싱

2. **템플릿 = React 컴포넌트**
   - `TemplateProps = { data: Invitation, isPreview?: boolean }`
   - 미리보기/실제 렌더링 동일 컴포넌트 사용

3. **모바일 우선 디자인**
   - 기본 = 모바일, `md:` = 데스크톱
   - 90%+ 모바일 트래픽 예상

### 기술 스택 확정
- ✅ Zod (스키마 검증)
- ✅ 네이티브 Intl (날짜 포맷)
- ✅ Framer Motion (애니메이션)
- ✅ Tailwind CSS (스타일링)
- ❌ date-fns (제거)

---

## 느낀 점/난이도/발견

### 난이도: 중 (3/5)
- Zod 스키마 작성: 쉬움 (이미 DB 스키마 참고)
- 템플릿 디자인: 중간 (반응형 조정 반복)
- 모바일 최적화: 시간 소요 (Playwright로 확인 반복)

### 발견
1. **Turbopack의 date-fns import 이슈**
   - `date-fns/locale` 경로 문제
   - 네이티브 Intl이 더 나은 선택이었음

2. **모바일 최적화는 반드시 실기기 확인 필요**
   - 데스크톱에서 보기 좋아도 모바일에서 이상할 수 있음
   - Playwright 375px 뷰포트로 확인 필수

3. **템플릿 시스템의 확장성**
   - Props만 통일하면 템플릿 무한 확장 가능
   - Modern, Vintage 등 추가는 쉬울 듯

### 만족스러운 점
- 깔끔한 코드 구조 (schemas, utils, templates 분리)
- 모바일 최적화 완료 (90% 트래픽 대응)
- 재사용 가능한 유틸리티 (date.ts)

---

## 남은 것/미정

### 이번 작업에서 남은 것
1. **갤러리 이미지**
   - 구조만 있고 샘플 이미지 없음
   - 실제 이미지는 청첩장 생성 시 업로드 예정

2. **템플릿 4개 추가**
   - Modern, Vintage, Floral, Minimal
   - Classic 기반으로 디자인만 변경

3. **DB 스키마 확장**
   - `content JSON` 필드 추가 필요
   - 부모님 정보, 계좌번호 등 저장

### 미정 사항
1. **템플릿 선택 UI 위치**
   - `/admin/invitations/new`에서 시작?
   - 아니면 `/admin/templates` 별도 페이지?
   - → 청첩장 생성 플로우 설계 시 결정

2. **이미지 업로드 방식**
   - Cloudflare R2 직접 업로드
   - 아니면 Next.js API 경유?
   - → 보안/성능 고려 필요

3. **템플릿 커스터마이징 범위**
   - 색상, 폰트만?
   - 섹션 on/off?
   - 드래그 앤 드롭 편집?
   - → MVP는 최소한으로, Phase 2에서 확장

---

## 다음 액션

### Roadmap Day 2-3: 청첩장 생성 기능
1. **DB 스키마 확장** (1일)
   - `invitations` 테이블에 필드 추가
   - Drizzle migration 실행
   - 관계 설정 (users ↔ invitations)

2. **템플릿 선택 UI** (0.5일)
   - TemplateCard, TemplateGrid 컴포넌트
   - `/admin/invitations/new` 페이지
   - 미리보기 모달

3. **청첩장 생성 폼** (1일)
   - 기본 정보 입력 (신랑/신부, 날짜, 장소)
   - 실시간 미리보기 (옆에 템플릿 렌더링)
   - Zod validation

4. **API 엔드포인트** (0.5일)
   - `POST /api/invitations` - 생성
   - `GET /api/invitations/:id` - 조회
   - `PATCH /api/invitations/:id` - 수정

### 우선순위
1. ⭐⭐⭐ DB 스키마 확장 (블로커)
2. ⭐⭐⭐ 청첩장 생성 API
3. ⭐⭐⭐ 템플릿 선택 UI
4. ⭐⭐ 실시간 미리보기

---

## 서랍 메모

### 아이디어
- **템플릿 마켓플레이스**: 디자이너가 템플릿 판매?
- **AI 문구 추천**: GPT로 인사말 자동 생성
- **다국어 지원**: 영어, 중국어 청첩장 (글로벌 확장)

### 기술 부채
- date-fns 완전 제거 확인 (package.json에 있는지?)
- 스크롤 인디케이터 제거한 애니메이션 코드 정리
- 샘플 이미지 경로 (`/images/sample-*.jpg`) 실제 파일 필요

### 참고 링크
- [WCAG 터치 타겟 가이드](https://www.w3.org/WAI/WCAG21/Understanding/target-size.html)
- [Intl.DateTimeFormat MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/DateTimeFormat)
- [Drizzle ORM Migrations](https://orm.drizzle.team/docs/migrations)

---

## 내 질문 평가 및 피드백

### 좋았던 질문
1. **"Phase 2의 목적이 뭐야?"**
   - 근본적인 문제 제기
   - 우선순위 재정립으로 이어짐
   - 시간 낭비 방지

2. **"그 schema 문서가 정의되어 있는데 거기 참고해서 해"**
   - 기존 작업 활용
   - 일관성 유지

3. **"util로 빼자"**
   - 코드 재사용성
   - 유지보수성 향상

### 개선할 점
1. **모바일 최적화 요청이 늦음**
   - 처음부터 "모바일 우선으로" 요청했으면 재작업 없었을 것
   - 다음엔 요구사항에 "모바일 기준" 명시

2. **템플릿 선택 UI 미리 언급**
   - 청첩장 생성 플로우 전체를 먼저 논의했으면
   - 나중에 beads 이슈로 추가하는 대신

### 전체 평가: ⭐⭐⭐⭐☆ (4/5)
- 명확한 방향 전환 (Admin Phase 2 → 템플릿)
- 실용적인 기술 선택 (date-fns 제거)
- 모바일 최적화 요청
- 전체 플로우 사전 설계는 아쉬움

---

## 커밋 내역

```bash
[feature/invitation-template df91ffc] feat: 청첩장 템플릿 시스템 구현 (Classic 템플릿)
5 files changed, 1038 insertions(+)
- schemas/invitation.ts
- lib/utils/date.ts
- components/templates/ClassicTemplate.tsx
- app/templates/preview/page.tsx
- docs/roadmap.md
```

브랜치: `feature/invitation-template`

---

**작성일**: 2026-02-03
**작성자**: Claude Sonnet 4.5 + 사용자
**작업 시간**: 약 3시간
**다음 작업**: 청첩장 생성 기능 (Day 2-3)
